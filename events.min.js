~function(t){function n(t,n){if(!t)throw new Error("Event name is required");return function(i){var e=o(this);return"function"==typeof i?e.sub(t,i,n):void e.pub(t,new h(this,i))}}var i=function(t){this.$events={},this.ctx=t},e="HybridEventHub"+Date.now(),o=function(t){return t[e]||(t[e]=new i(t))},a=i.prototype,r=function(t,n){this.$callbacks=[],this.$options=n||{},this.$name=t},s=r.prototype,c=function(t){return function(){return t}},p=c(!0),u=c(!1),h=function(t,n){return n instanceof h?(n.currentTarget=t,n):(this.target=this.currentTarget=t,this.data=n,this.isPropagationStopped=u,void(this.isImmediatePropagationStopped=u))},l=h.prototype;l.stopImmediatePropagation=function(){this.isPropagationStopped=this.isImmediatePropagationStopped=p},l.stopPropagation=function(){this.isPropagationStopped=p},s.add=function(t,n){var i=this,e=i.$callbacks,o=i.$options,a=o.setup,r=o.add,s=i.$name,c=e.length;return e.push(t),a&&!c&&a.call(n,s),r&&r.call(n,s),function(){i.remove(t,n)}},s.toggle=function(t,n){return this[~this.$callbacks.indexOf(t)?"remove":"add"](t,n)},s.remove=function(t,n){var i=this.$callbacks,e=this.$name,o=i.indexOf(t),a=this.$options,r=a.remove,s=a.teardown;~o&&(i.splice(o,1),r&&r.call(n,e),s&&!i.length&&s.call(n,e))},s.fire=function(t){var n=this.$callbacks,i=n.length,e=0,o=this.$options.propagate,a=t.currentTarget;if(i)for(n=n.slice(0);i>e&&!t.isImmediatePropagationStopped();)n[e++].call(a,t);o&&!t.isPropagationStopped()&&(a=o.call(a),a&&a[this.$name](t))},a.sub=function(t,n,i){var e=this.$events[t];return e||(this.$events[t]=e=new r(t,i)),e.toggle(n,this.ctx)},a.pub=function(t,n){this.$events[t].fire(n)},t.HybridEvent=n}(window);